<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="../src/imgs/icon.png" type="image/x-icon">
  <link rel="stylesheet" href="../src/css/default.css">
  <link rel="stylesheet" href="../src/css/admin.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/282aa7276a.js" crossorigin="anonymous"></script>
  <title>Painel Administrativo - Elite House</title>
</head>
<body>
  <div class="admin-container">
      <div class="admin-sidebar">
          <div class="admin-sidebar-logo">
              <img src="../src/imgs/icon.png" alt="Elite House">
          </div>
          <ul class="admin-menu">
              <li><a href="#" class="active" data-page="dashboard"><i class="fa-solid fa-gauge"></i> Dashboard</a></li>
              <li><a href="#" data-page="properties"><i class="fa-solid fa-building"></i> Imóveis</a></li>
              <li><a href="#" data-page="featured" data-role="admin,dev"><i class="fa-solid fa-star"></i> Destaques</a></li>
              <li class="menu-separator"></li>
              <!-- Modificar o item de menu de clientes para incluir um badge de notificação -->
<li><a href="#" data-page="clients" data-role="admin,dev,corretor"><i class="fa-solid fa-address-book"></i> Clientes <span id="pending-clients-badge" class="menu-badge" style="display: none;">0</span></a></li>
              <li class="menu-separator"></li>
              <li><a href="#" data-page="users" data-role="admin,dev"><i class="fa-solid fa-users-gear"></i> Usuários</a></li>
              <li><a href="#" data-page="logs" data-role="admin,dev"><i class="fa-solid fa-list"></i> Logs de Atividade</a></li>
              <li><a href="#" data-page="settings"><i class="fa-solid fa-gear"></i> Configurações</a></li>
              <li><a href="#" data-page="database" data-role="dev"><i class="fa-solid fa-database"></i> Banco de Dados</a></li>
          </ul>
      </div>
      
      <div class="admin-content">
          <div class="admin-header">
              <div class="admin-title">
                  <h1>Dashboard</h1>
              </div>
              <div class="admin-user-info">
                  <span id="user-welcome">Bem-vindo</span>
                  <button class="admin-logout" id="logout-btn">Sair</button>
              </div>
          </div>
          
          <!-- Conteúdo dinâmico será carregado aqui -->
          <div id="page-content">
              <!-- Dashboard - Removida a seção de atividades recentes -->
              <div id="dashboard-page">
    <div class="admin-stats general-stats">
        <div class="stat-card" data-stat="properties">
            <i class="fa-solid fa-building"></i>
            <h3 id="total-properties">0</h3>
            <p>Total de Imóveis</p>
        </div>
        <div class="stat-card" data-stat="featured">
            <i class="fa-solid fa-star"></i>
            <h3 id="featured-properties">0</h3>
            <p>Imóveis em Destaque</p>
        </div>
        <div class="stat-card" data-stat="clients">
            <i class="fa-solid fa-address-book"></i>
            <h3 id="total-clients">0</h3>
            <p>Total de Clientes</p>
        </div>
        <div class="stat-card" data-stat="views">
            <i class="fa-solid fa-eye"></i>
            <h3 id="total-views">0</h3>
            <p>Visualizações</p>
        </div>
    </div>
    
    <!-- Estatísticas específicas para corretores -->
    <div class="admin-stats" id="broker-stats" style="display: none;">
        <div class="stat-card">
            <i class="fa-solid fa-users"></i>
            <h3 id="broker-clients">0</h3>
            <p>Meus Clientes</p>
        </div>
        <div class="stat-card">
            <i class="fa-solid fa-file-contract"></i>
            <h3 id="broker-pending-docs">0</h3>
            <p>Documentos em Análise</p>
        </div>
        <div class="stat-card">
            <i class="fa-solid fa-handshake"></i>
            <h3 id="broker-sales">0</h3>
            <p>Vendas Realizadas</p>
        </div>
    </div>
    
    <!-- Botão de zerar métricas (apenas para DEV) -->
    <div id="dev-actions" class="dev-actions" style="display: none;">
        <button id="reset-metrics-btn" class="admin-button danger">
            <i class="fa-solid fa-eraser"></i> Zerar Métricas de Acesso
        </button>
    </div>
</div>
              
              <!-- Página de Imóveis -->
              <div id="properties-page" style="display: none;">
                  <div class="admin-card">
                      <div class="admin-card-header">
                          <h2>Gerenciar Imóveis</h2>
                          <div class="admin-card-actions">
                              <button class="admin-button secondary csv-button" id="export-properties-btn">
                                  <i class="fa-solid fa-file-export"></i> Exportar CSV
                              </button>
                              <button class="admin-button secondary csv-button" id="import-properties-btn">
                                  <i class="fa-solid fa-file-import"></i> Importar CSV
                              </button>
                              <input type="file" id="import-properties-file" accept=".csv" style="display: none;">
                          </div>
                      </div>
                      
                      <button class="admin-button add" id="add-property-btn">
                          <i class="fa-solid fa-plus"></i> Adicionar Novo Imóvel
                      </button>
                      <div id="property-form-container" style="display: none; margin-top: 20px;">
                          <form id="property-form">
                              <input type="hidden" id="property-id">
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="property-title">Título</label>
                                      <input type="text" id="property-title" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="property-type">Tipo</label>
                                      <select id="property-type" required>
                                          <option value="Casa">Casa</option>
                                          <option value="Apartamento">Apartamento</option>
                                          <option value="Terreno">Terreno</option>
                                          <option value="Comercial">Comercial</option>
                                      </select>
                                  </div>
                              </div>
                              
                              <div class="admin-form-group">
                                  <label for="property-location">Localização</label>
                                  <input type="text" id="property-location" required>
                              </div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="property-area">Área (m²)</label>
                                      <input type="number" id="property-area" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="property-bedrooms">Quartos</label>
                                      <input type="number" id="property-bedrooms" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="property-bathrooms">Banheiros</label>
                                      <input type="number" id="property-bathrooms" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="property-garage">Vagas de Garagem</label>
                                      <input type="number" id="property-garage" required>
                                  </div>
                              </div>
                              
                              <div class="admin-form-group">
                                  <label for="property-price">Preço (R$)</label>
                                  <input type="number" id="property-price" required>
                              </div>
                              
                              <div class="admin-form-group">
                                  <label for="property-description">Descrição</label>
                                  <textarea id="property-description" required></textarea>
                              </div>
                              
                              <div class="admin-form-group">
                                  <label for="property-image">Imagem (URL)</label>
                                  <input type="text" id="property-image" required>
                                  <div class="image-preview" id="image-preview"></div>
                              </div>
                              
                              <div class="admin-form-group" id="featured-checkbox-container">
                                  <label>
                                      <input type="checkbox" id="property-featured">
                                      Destacar na página inicial
                                  </label>
                              </div>
                              
                              <div style="margin-top: 20px;">
                                  <button type="submit" class="admin-button add">Salvar</button>
                                  <button type="button" class="admin-button secondary" id="cancel-property-btn">Cancelar</button>
                              </div>
                          </form>
                      </div>
                      
                      <div style="margin-top: 20px;">
                          <table class="admin-table">
                              <thead>
                                  <tr>
                                      <th>Ref.</th>
                                      <th>Título</th>
                                      <th>Tipo</th>
                                      <th>Localização</th>
                                      <th>Preço</th>
                                      <th>Destaque</th>
                                      <th>Ações</th>
                                  </tr>
                              </thead>
                              <tbody id="properties-table-body">
                                  <!-- Dados dos imóveis serão carregados aqui -->
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>
              
              <!-- Página de Destaques -->
              <div id="featured-page" style="display: none;">
                  <div class="admin-card">
                      <h2>Gerenciar Destaques</h2>
                      <p>Selecione os imóveis que aparecerão em destaque no slider da página inicial.</p>
                      
                      <div id="featured-properties-list" style="margin-top: 20px;">
                          <!-- Lista de imóveis em destaque será carregada aqui -->
                      </div>
                  </div>
              </div>
              
              <!-- Página de Clientes -->
              <div id="clients-page" style="display: none;">
                  <div class="admin-card">
                      <!-- Modificar a estrutura do header da página de clientes para separar os botões CSV do toggle de visualização -->
<div class="clients-header">
    <h2>Gerenciar Clientes</h2>
    <div class="admin-card-actions">
        <div class="csv-buttons">
            <button class="admin-button secondary csv-button" id="export-clients-btn">
                <i class="fa-solid fa-file-export"></i> Exportar CSV
            </button>
            <button class="admin-button secondary csv-button" id="import-clients-btn">
                <i class="fa-solid fa-file-import"></i> Importar CSV
            </button>
            <input type="file" id="import-clients-file" accept=".csv" style="display: none;">
        </div>
    </div>
</div>

<!-- Adicionar um container separado para o toggle de visualização -->
<div class="view-toggle-wrapper">
    <div class="view-toggle" id="view-toggle-container">
    <button class="view-toggle-btn active" data-view="list" id="list-view-btn">
        <i class="fa-solid fa-list"></i> Lista
    </button>
    <button class="view-toggle-btn" data-view="kanban" id="kanban-view-btn">
        <i class="fa-solid fa-columns"></i> Kanban
    </button>
</div>
</div>

<!-- Botão para visualizar clientes pendentes (apenas para admin e dev) -->
<button class="admin-button secondary" id="view-pending-clients-btn" style="margin-left: 10px;">
    <i class="fa-solid fa-clock"></i> Clientes Pendentes
</button>
                      
                      <button class="admin-button add" id="add-client-btn">
                          <i class="fa-solid fa-plus"></i> Adicionar Novo Cliente
                      </button>
                      
                      <div id="client-form-container" style="display: none; margin-top: 20px;">
                          <form id="client-form">
                              <input type="hidden" id="client-id">
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="client-name">Nome Completo</label>
                                      <input type="text" id="client-name" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="client-cpf">CPF</label>
                                      <input type="text" id="client-cpf" placeholder="000.000.000-00" required>
                                  </div>
                              </div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="client-email">Email</label>
                                      <input type="email" id="client-email" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="client-phone">Telefone</label>
                                      <input type="text" id="client-phone" placeholder="(00) 00000-0000" required>
                                  </div>
                              </div>
                              
                              
<div class="admin-form-row">
    <div class="admin-form-group" style="flex: 1;">
        <label for="client-cep">CEP</label>
        <input type="text" id="client-cep" placeholder="00000-000" maxlength="9">
    </div>
    <div class="admin-form-group" style="flex: 2;">
        <label for="client-street">Rua</label>
        <input type="text" id="client-street" placeholder="Rua, Avenida, etc">
    </div>
</div>
<div class="admin-form-row">
    <div class="admin-form-group" style="flex: 1;">
        <label for="client-number">Número</label>
        <input type="text" id="client-number" placeholder="Número">
    </div>
    <div class="admin-form-group" style="flex: 2;">
        <label for="client-neighborhood">Bairro</label>
        <input type="text" id="client-neighborhood" placeholder="Bairro">
    </div>
</div>
<div class="admin-form-row">
    <div class="admin-form-group" style="flex: 2;">
        <label for="client-city">Cidade</label>
        <input type="text" id="client-city" placeholder="Cidade">
    </div>
    <div class="admin-form-group" style="flex: 1;">
        <label for="client-state">Estado</label>
        <input type="text" id="client-state" placeholder="UF" maxlength="2">
    </div>
</div>
<div class="admin-form-group">
    <label for="client-complement">Complemento</label>
    <input type="text" id="client-complement" placeholder="Apartamento, bloco, etc. (opcional)">
</div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group" id="client-status-container">
                                      <label for="client-status">Status</label>
                                      <select id="client-status" required>
                                          <option value="Novo">Novo</option>
                                          <option value="Atendimento">Atendimento</option>
                                          <option value="Análise documental">Análise documental</option>
                                          <option value="Análise bancária">Análise bancária</option>
                                          <option value="Aprovado">Aprovado</option>
                                          <option value="Condicionado">Condicionado</option>
                                          <option value="Reprovado">Reprovado</option>
                                          <option value="Venda realizada">Venda realizada</option>
                                          <option value="Distrato">Distrato</option>
                                      </select>
                                  </div>
                                  <div class="admin-form-group" id="client-broker-container">
                                      <label for="client-broker">Corretor Responsável</label>
                                      <select id="client-broker" required>
                                          <!-- Opções de corretores serão carregadas dinamicamente -->
                                      </select>
                                  </div>
                              </div>
                              
                              <div class="admin-form-group">
                                  <label for="client-notes">Observações</label>
                                  <textarea id="client-notes"></textarea>
                              </div>
                              
                              <div style="margin-top: 20px;">
                                  <button type="submit" class="admin-button add">Salvar</button>
                                  <button type="button" class="admin-button secondary" id="cancel-client-btn">Cancelar</button>
                              </div>
                          </form>
                      </div>
                      
                      <!-- Filtros e pesquisa para clientes -->
                      <div class="filters-container" style="margin-top: 20px;">
                          <div class="admin-form-row">
                              <div class="admin-form-group" style="flex: 3;">
                                  <input type="text" id="search-client" placeholder="Pesquisar por nome, email, telefone ou CPF...">
                              </div>
                              <div class="admin-form-group" style="flex: 1;">
                                  <button id="search-client-btn" class="admin-button">Pesquisar</button>
                              </div>
                          </div>
                          
                          <!-- Filtro de corretores (apenas para admin e dev) -->
                          <div id="broker-filter-container" class="admin-form-row" style="margin-top: 10px; display: none;">
                              <div class="admin-form-group">
                                  <label for="filter-broker">Filtrar por Corretor</label>
                                  <select id="filter-broker">
                                      <option value="all">Todos os Corretores</option>
                                      <!-- Opções de corretores serão carregadas dinamicamente -->
                                  </select>
                              </div>
                              <div class="admin-form-group" style="align-self: flex-end;">
                                  <button id="apply-broker-filter" class="admin-button">Aplicar Filtro</button>
                              </div>
                          </div>
                      </div>
                      
                      <!-- Visualização em Lista -->
                      <div id="clients-list-view" style="margin-top: 20px;">
                          <table class="admin-table">
                              <thead>
                                  <tr>
                                      <th>ID</th>
                                      <th>Nome</th>
                                      <th>Telefone</th>
                                      <th>Email</th>
                                      <th>Status</th>
                                      <th>Corretor</th>
                                      <th>Ações</th>
                                  </tr>
                              </thead>
                              <tbody id="clients-table-body">
                                  <!-- Dados dos clientes serão carregados aqui -->
                              </tbody>
                          </table>
                      </div>
                      
                      <!-- Visualização em Kanban -->
                      <div id="clients-kanban-view" style="display: none; margin-top: 20px;">
                          <div class="kanban-container">
                              <div class="kanban-column" data-status="Novo">
                                  <div class="kanban-column-header">
                                      <h3>Novo</h3>
                                      <span class="kanban-count" id="kanban-count-novo">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-novo">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Atendimento">
                                  <div class="kanban-column-header">
                                      <h3>Atendimento</h3>
                                      <span class="kanban-count" id="kanban-count-atendimento">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-atendimento">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Análise documental">
                                  <div class="kanban-column-header">
                                      <h3>Análise documental</h3>
                                      <span class="kanban-count" id="kanban-count-analise-documental">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-analise-documental">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Análise bancária">
                                  <div class="kanban-column-header">
                                      <h3>Análise bancária</h3>
                                      <span class="kanban-count" id="kanban-count-analise-bancaria">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-analise-bancaria">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Aprovado">
                                  <div class="kanban-column-header">
                                      <h3>Aprovado</h3>
                                      <span class="kanban-count" id="kanban-count-aprovado">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-aprovado">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Condicionado">
                                  <div class="kanban-column-header">
                                      <h3>Condicionado</h3>
                                      <span class="kanban-count" id="kanban-count-condicionado">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-condicionado">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Reprovado">
                                  <div class="kanban-column-header">
                                      <h3>Reprovado</h3>
                                      <span class="kanban-count" id="kanban-count-reprovado">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-reprovado">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Venda realizada">
                                  <div class="kanban-column-header">
                                      <h3>Venda realizada</h3>
                                      <span class="kanban-count" id="kanban-count-venda">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-venda">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                              
                              <div class="kanban-column" data-status="Distrato">
                                  <div class="kanban-column-header">
                                      <h3>Distrato</h3>
                                      <span class="kanban-count" id="kanban-count-distrato">0</span>
                                  </div>
                                  <div class="kanban-cards" id="kanban-cards-distrato">
                                      <!-- Cartões de clientes serão carregados aqui -->
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              
              <!-- Seção de Clientes Pendentes -->
<div id="pending-clients-section" style="display: none; margin-top: 20px;">
    <div class="admin-card">
        <div class="admin-card-header">
            <h2>Clientes Pendentes</h2>
            <button class="admin-button secondary" id="close-pending-clients-btn">
                <i class="fa-solid fa-times"></i> Fechar
            </button>
        </div>
        <p>Clientes que ainda não foram atribuídos a um corretor.</p>
        
        <div style="margin-top: 20px;">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nome</th>
                        <th>Telefone</th>
                        <th>Email</th>
                        <th>Data de Contato</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody id="pending-clients-table-body">
                    <!-- Dados dos clientes pendentes serão carregados aqui -->
                </tbody>
            </table>
        </div>
    </div>
</div>
              
              <!-- Página de Usuários (apenas para Admin e DEV) -->
              <div id="users-page" style="display: none;">
                  <div class="admin-card">
                      <div class="admin-card-header">
                          <h2>Gerenciar Usuários</h2>
                          <div class="admin-card-actions">
                              <button class="admin-button secondary csv-button" id="export-users-btn">
                                  <i class="fa-solid fa-file-export"></i> Exportar CSV
                              </button>
                              <button class="admin-button secondary csv-button" id="import-users-btn">
                                  <i class="fa-solid fa-file-import"></i> Importar CSV
                              </button>
                              <input type="file" id="import-users-file" accept=".csv" style="display: none;">
                          </div>
                      </div>
                      
                      <button class="admin-button add" id="add-user-btn">
                          <i class="fa-solid fa-plus"></i> Adicionar Novo Usuário
                      </button>
                      
                      <div id="user-form-container" style="display: none; margin-top: 20px;">
                          <form id="user-form">
                              <input type="hidden" id="user-id">
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="user-name">Nome Completo</label>
                                      <input type="text" id="user-name" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="user-cpf">CPF</label>
                                      <input type="text" id="user-cpf" placeholder="000.000.000-00" required>
                                  </div>
                              </div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="user-email">Email</label>
                                      <input type="email" id="user-email" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="user-phone">Telefone</label>
                                      <input type="text" id="user-phone" placeholder="(00) 00000-0000" required>
                                  </div>
                              </div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="user-birth">Data de Nascimento</label>
                                      <input type="date" id="user-birth" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="user-address">Endereço Completo</label>
                                      <input type="text" id="user-address" placeholder="Rua, número, bairro, cidade, estado, CEP" required>
                                  </div>
                              </div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="user-emergency-contact">Nome do Contato de Emergência</label>
                                      <input type="text" id="user-emergency-contact" required>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="user-emergency-phone">Telefone de Emergência</label>
                                      <input type="text" id="user-emergency-phone" placeholder="(00) 00000-0000" required>
                                  </div>
                              </div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="user-username">Nome de Usuário</label>
                                      <input type="text" id="user-username" required>
                                  </div>
                                  <div class="admin-form-group password-field">
                                      <label for="user-password">Senha <span id="password-required-text">(obrigatório para novos usuários)</span></label>
                                      <input type="password" id="user-password">
                                  </div>
                              </div>
                              
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="user-role">Nível de Acesso</label>
                                      <select id="user-role" required>
                                          <option value="corretor">Corretor</option>
                                          <option value="admin" class="admin-only">Administrador</option>
                                          <option value="dev" class="dev-only">Desenvolvedor</option>
                                      </select>
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="user-active">Status</label>
                                      <select id="user-active" required>
                                          <option value="true">Ativo</option>
                                          <option value="false">Inativo</option>
                                      </select>
                                  </div>
                              </div>
                              
                              <div style="margin-top: 20px;">
                                  <button type="submit" class="admin-button add">Salvar</button>
                                  <button type="button" class="admin-button secondary" id="cancel-user-btn">Cancelar</button>
                              </div>
                          </form>
                      </div>
                      
                      <div style="margin-top: 20px;">
                          <table class="admin-table">
                              <thead>
                                  <tr>
                                      <th>ID</th>
                                      <th>Nome</th>
                                      <th>Telefone</th>
                                      <th>Email</th>
                                      <th>Nível</th>
                                      <th>Status</th>
                                      <th>Ações</th>
                                  </tr>
                              </thead>
                              <tbody id="users-table-body">
                                  <!-- Dados dos usuários serão carregados aqui -->
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>
              
              <!-- Página de Logs -->
              <!-- Modificar a seção de logs para incluir a legenda de cores -->
<div id="logs-page" style="display: none;">
  <div class="admin-card">
    <div class="logs-header">
      <h2>Logs de Atividade</h2>
      <div class="logs-actions">
        <button id="export-logs-btn" class="admin-button">
          <i class="fa-solid fa-file-csv"></i> Exportar CSV
        </button>
        <button id="refresh-logs-btn" class="admin-button secondary">
          <i class="fa-solid fa-sync"></i> Atualizar
        </button>
      </div>
    </div>
    
    <!-- Adicionar legenda para as cores -->
    <div class="logs-legend">
      <div class="legend-item">
        <div class="legend-color" style="background-color: #4CAF50;"></div>
        <span>Criação</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #2196F3;"></div>
        <span>Atualização</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #F44336;"></div>
        <span>Exclusão</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #9C27B0;"></div>
        <span>Login/Logout</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #FF9800;"></div>
        <span>Exportação/Importação</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #FFEB3B;"></div>
        <span>Destaques</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #00BCD4;"></div>
        <span>Atribuição</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #795548;"></div>
        <span>Reset</span>
      </div>
    </div>
    
    <div id="activity-logs">
      <!-- Logs de atividade serão carregados aqui -->
    </div>
  </div>
</div>
              
              <!-- Página de Configurações -->
              <div id="settings-page" style="display: none;">
                  <div class="admin-card">
                      <h2>Configurações da Conta</h2>
                      <form id="admin-settings-form">
                          <div class="admin-form-row">
                              <div class="admin-form-group">
                                  <label for="settings-name">Nome Completo</label>
                                  <input type="text" id="settings-name" required>
                              </div>
                              <div class="admin-form-group">
                                  <label for="settings-cpf">CPF</label>
                                  <input type="text" id="settings-cpf" placeholder="000.000.000-00" required>
                              </div>
                          </div>
                          
                          <div class="admin-form-row">
                              <div class="admin-form-group">
                                  <label for="settings-email">Email</label>
                                  <input type="email" id="settings-email" required>
                              </div>
                              <div class="admin-form-group">
                                  <label for="settings-phone">Telefone</label>
                                  <input type="text" id="settings-phone" placeholder="(00) 00000-0000" required>
                              </div>
                          </div>
                          
                          <div class="admin-form-row">
                              <div class="admin-form-group">
                                  <label for="settings-birth">Data de Nascimento</label>
                                  <input type="date" id="settings-birth" required>
                              </div>
                              <div class="admin-form-group">
                                  <label for="settings-address">Endereço Completo</label>
                                  <input type="text" id="settings-address" placeholder="Rua, número, bairro, cidade, estado, CEP" required>
                              </div>
                          </div>
                          
                          <div class="admin-form-row">
                              <div class="admin-form-group">
                                  <label for="settings-emergency-contact">Nome do Contato de Emergência</label>
                                  <input type="text" id="settings-emergency-contact" required>
                              </div>
                              <div class="admin-form-group">
                                  <label for="settings-emergency-phone">Telefone de Emergência</label>
                              </div>
                              <div class="admin-form-group">
                                  <label for="settings-emergency-phone">Telefone de Emergência</label>
                                  <input type="text" id="settings-emergency-phone" placeholder="(00) 00000-0000" required>
                              </div>
                          </div>
                          
                          <div class="admin-form-row">
                              <div class="admin-form-group">
                                  <label for="settings-username">Nome de Usuário</label>
                                  <input type="text" id="settings-username" required>
                              </div>
                              <div class="admin-form-group">
                                  <label for="settings-password">Nova Senha (deixe em branco para manter a atual)</label>
                                  <input type="password" id="settings-password">
                              </div>
                          </div>
                          
                          <div class="admin-form-group">
                              <label for="settings-password-confirm">Confirmar Nova Senha</label>
                              <input type="password" id="settings-password-confirm">
                          </div>
                          
                          <div id="settings-error" class="error-message"></div>
                          <button type="submit" class="admin-button add">Salvar Alterações</button>
                      </form>
                  </div>
              </div>
              
              <!-- Página de Banco de Dados -->
              <div id="database-page" style="display: none;">
                  <div class="admin-card">
                      <h2>Gerenciamento de Banco de Dados</h2>
                      <p>Nesta seção você pode exportar e importar dados do sistema em formato CSV.</p>
                      
                      <div class="database-section">
                          <h3>Backup Completo</h3>
                          <p>Faça backup de todos os dados do sistema em arquivos CSV.</p>
                          <div class="admin-form-row">
                              <button id="export-all-btn" class="admin-button">
                                  <i class="fa-solid fa-download"></i> Exportar Todos os Dados
                              </button>
                              <button id="import-all-btn" class="admin-button secondary">
                                  <i class="fa-solid fa-upload"></i> Importar Todos os Dados
                              </button>
                          </div>
                          <div id="import-all-container" style="display: none; margin-top: 20px;">
                              <div class="admin-form-row">
                                  <div class="admin-form-group">
                                      <label for="import-clients-file-all">Arquivo de Clientes (CSV)</label>
                                      <input type="file" id="import-clients-file-all" accept=".csv">
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="import-users-file-all">Arquivo de Usuários (CSV)</label>
                                      <input type="file" id="import-users-file-all" accept=".csv">
                                  </div>
                                  <div class="admin-form-group">
                                      <label for="import-properties-file-all">Arquivo de Imóveis (CSV)</label>
                                      <input type="file" id="import-properties-file-all" accept=".csv">
                                  </div>
                              </div>
                              <div class="admin-form-row" style="margin-top: 10px;">
                                  <button id="process-import-all-btn" class="admin-button add">
                                      <i class="fa-solid fa-check"></i> Processar Importação
                                  </button>
                                  <button id="cancel-import-all-btn" class="admin-button secondary">
                                      <i class="fa-solid fa-times"></i> Cancelar
                                  </button>
                              </div>
                          </div>
                      </div>
                      
                      <div class="database-section">
                          <h3>Exportação Individual</h3>
                          <p>Exporte dados específicos do sistema.</p>
                          <div class="admin-form-row">
                              <button id="export-clients-db-btn" class="admin-button">
                                  <i class="fa-solid fa-users"></i> Exportar Clientes
                              </button>
                              <button id="export-users-db-btn" class="admin-button">
                                  <i class="fa-solid fa-user-gear"></i> Exportar Usuários
                              </button>
                              <button id="export-properties-db-btn" class="admin-button">
                                  <i class="fa-solid fa-building"></i> Exportar Imóveis
                              </button>
                          </div>
                      </div>
                      
                      <div class="database-section">
                          <h3>Importação Individual</h3>
                          <p>Importe dados específicos para o sistema.</p>
                          <div class="admin-form-row">
                              <div class="admin-form-group">
                                  <label for="import-db-file">Selecione o arquivo CSV</label>
                                  <input type="file" id="import-db-file" accept=".csv">
                              </div>
                              <div class="admin-form-group">
                                  <label for="import-db-type">Tipo de Dados</label>
                                  <select id="import-db-type">
                                      <option value="clients">Clientes</option>
                                      <option value="users">Usuários</option>
                                      <option value="properties">Imóveis</option>
                                  </select>
                              </div>
                          </div>
                          <div class="admin-form-row" style="margin-top: 10px;">
                              <button id="process-import-db-btn" class="admin-button add">
                                  <i class="fa-solid fa-file-import"></i> Importar Dados
                              </button>
                          </div>
                      </div>
                      
                      <div class="database-section">
                          <h3>Limpar Dados</h3>
                          <p>Atenção: Esta ação não pode ser desfeita!</p>
                          <div class="admin-form-row">
                              <button id="clear-clients-btn" class="admin-button danger">
                                  <i class="fa-solid fa-trash"></i> Limpar Clientes
                              </button>
                              <button id="clear-users-btn" class="admin-button danger">
                                  <i class="fa-solid fa-trash"></i> Limpar Usuários
                              </button>
                              <button id="clear-properties-btn" class="admin-button danger">
                                  <i class="fa-solid fa-trash"></i> Limpar Imóveis
                              </button>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <script src="../src/js/csv-handler.js"></script>
  <script src="../src/js/admin.js"></script>
  <script src="../src/js/database-manager.js"></script>
  <!-- Adicionar script para garantir que os botões funcionem corretamente -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  console.log("Dashboard carregado")
  
  // Verificar se o usuário está logado
  const currentUser = JSON.parse(localStorage.getItem("currentUser") || "{}")
  if (!currentUser.id) {
    window.location.href = "login.html"
    return
  }
  
  // Garantir que o botão de logout funcione
  const logoutBtn = document.getElementById("logout-btn")
  if (logoutBtn) {
    logoutBtn.addEventListener("click", function() {
      console.log("Botão de logout clicado")
      if (confirm("Deseja realmente sair?")) {
        localStorage.removeItem("currentUser")
        window.location.href = "login.html"
      }
    })
  }
  
  // Garantir que os itens de menu funcionem
  document.querySelectorAll(".admin-menu a").forEach(link => {
    link.addEventListener("click", function(e) {
      e.preventDefault()
      console.log("Item de menu clicado:", this.textContent.trim())
      
      // Remover classe active de todos os links
      document.querySelectorAll(".admin-menu a").forEach(l => l.classList.remove("active"))
      
      // Adicionar classe active ao link clicado
      this.classList.add("active")
      
      // Obter a página a ser exibida
      const page = this.getAttribute("data-page")
      
      // Esconder todas as páginas
      document.querySelectorAll("#page-content > div").forEach(div => {
        div.style.display = "none"
      })
      
      // Exibir a página selecionada
      const selectedPage = document.getElementById(`${page}-page`)
      if (selectedPage) {
        selectedPage.style.display = "block"
        
        // Se for a página de clientes, garantir que a visualização em lista seja exibida por padrão
        if (page === "clients") {
          document.getElementById("clients-list-view").style.display = "block"
          document.getElementById("clients-kanban-view").style.display = "none"
          
          // Garantir que o botão de lista esteja ativo
          document.querySelectorAll(".view-toggle-btn").forEach(btn => {
            if (btn.getAttribute("data-view") === "list") {
              btn.classList.add("active")
            } else {
              btn.classList.remove("active")
            }
          })
          
          // Adicionar event listeners para os botões de toggle de visualização
          document.querySelectorAll(".view-toggle-btn").forEach(btn => {
            btn.addEventListener("click", function() {
              console.log("Botão de toggle clicado:", this.getAttribute("data-view"))
              
              // Remover classe active de todos os botões
              document.querySelectorAll(".view-toggle-btn").forEach(b => b.classList.remove("active"))
              
              // Adicionar classe active ao botão clicado
              this.classList.add("active")
              
              // Obter o tipo de visualização
              const viewType = this.getAttribute("data-view")
              
              // Esconder todas as visualizações
              document.getElementById("clients-list-view").style.display = "none"
              document.getElementById("clients-kanban-view").style.display = "none"
              
              // Mostrar a visualização selecionada
              if (viewType === "list") {
                document.getElementById("clients-list-view").style.display = "block"
              } else if (viewType === "kanban") {
                document.getElementById("clients-kanban-view").style.display = "block"
              }
            })
          })
        }
      }
      
      // Atualizar o título
      const titleElement = document.querySelector(".admin-title h1")
      if (titleElement) {
        titleElement.textContent = this.textContent.trim()
      }
    })
  })
  
  // Ativar o primeiro item do menu por padrão
  const firstMenuItem = document.querySelector(".admin-menu a")
  if (firstMenuItem) {
    firstMenuItem.click()
  }
})
</script>
<script>
// Script específico para controlar a visualização de clientes
document.addEventListener("DOMContentLoaded", function() {
    // Elementos de visualização
    const listViewBtn = document.getElementById("list-view-btn");
    const kanbanViewBtn = document.getElementById("kanban-view-btn");
    const listView = document.getElementById("clients-list-view");
    const kanbanView = document.getElementById("clients-kanban-view");
    
    if (listViewBtn && kanbanViewBtn && listView && kanbanView) {
        console.log("Inicializando controle de visualização de clientes");
        
        // Função para mostrar visualização em lista
        function showListView() {
            console.log("Mostrando visualização em lista");
            listView.style.display = "block";
            kanbanView.style.display = "none";
            // Remover a classe visible para garantir que o CSS funcione
            kanbanView.classList.remove("visible");
            listViewBtn.classList.add("active");
            kanbanViewBtn.classList.remove("active");
        }
        
        // Função para mostrar visualização kanban
        function showKanbanView() {
            console.log("Mostrando visualização kanban");
            listView.style.display = "none";
            // Adicionar a classe visible para permitir que o CSS mostre o kanban
            kanbanView.classList.add("visible");
            kanbanView.style.display = "block";
            kanbanViewBtn.classList.add("active");
            listViewBtn.classList.remove("active");
            
            // Recarregar dados do Kanban se necessário
            if (typeof loadKanbanViewData === 'function') {
                loadKanbanViewData();
            }
        }
        
        // Adicionar event listeners aos botões
        listViewBtn.addEventListener("click", function() {
            showListView();
            // Forçar ocultação do Kanban após um pequeno delay
            setTimeout(function() {
                kanbanView.style.display = "none";
                kanbanView.classList.remove("visible");
            }, 50);
        });
        
        kanbanViewBtn.addEventListener("click", showKanbanView);
        
        // Garantir que a visualização em lista seja exibida por padrão
        showListView();
        
        // Forçar ocultação do Kanban após carregamento completo da página
        setTimeout(function() {
            if (!kanbanViewBtn.classList.contains("active")) {
                kanbanView.style.display = "none";
                kanbanView.classList.remove("visible");
            }
        }, 500);
        
        // Garantir que a visualização em lista seja exibida quando a página de clientes for carregada
        document.querySelectorAll(".admin-menu a").forEach(link => {
            if (link.getAttribute("data-page") === "clients") {
                link.addEventListener("click", function() {
                    setTimeout(showListView, 100);
                    // Forçar ocultação do Kanban após navegação
                    setTimeout(function() {
                        kanbanView.style.display = "none";
                        kanbanView.classList.remove("visible");
                    }, 200);
                });
            }
        });
    }
});
</script>
<!-- Adicionar script para garantir que o botão de clientes pendentes funcione corretamente -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    // Configurar o botão de clientes pendentes
    const viewPendingClientsBtn = document.getElementById("view-pending-clients-btn");
    const pendingClientsSection = document.getElementById("pending-clients-section");
    const closePendingClientsBtn = document.getElementById("close-pending-clients-btn");
    const clientsListView = document.getElementById("clients-list-view");
    const clientsKanbanView = document.getElementById("clients-kanban-view");

    if (viewPendingClientsBtn && pendingClientsSection && closePendingClientsBtn) {
        console.log("Configurando botões de clientes pendentes");
        
        // Função para carregar clientes pendentes
        function loadPendingClients() {
            try {
                const tableBody = document.getElementById("pending-clients-table-body");
                if (!tableBody) {
                    console.error("Elemento pending-clients-table-body não encontrado");
                    return;
                }

                tableBody.innerHTML = "";

                // Obter clientes do localStorage
                const clients = JSON.parse(localStorage.getItem("clients") || "[]");
                console.log("Total de clientes:", clients.length);

                // Filtrar apenas clientes pendentes
                const pendingClients = clients.filter(client => client.isPending === true);
                console.log("Clientes pendentes encontrados:", pendingClients.length);

                // Renderizar clientes pendentes
                if (pendingClients.length === 0) {
                    tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Nenhum cliente pendente encontrado.</td></tr>';
                    return;
                }

                pendingClients.forEach(client => {
                    const row = document.createElement("tr");
                    row.classList.add("pending-client");

                    // Formatar data de contato
                    const contactDate = client.contactDate ? new Date(client.contactDate).toLocaleDateString("pt-BR") : "N/A";

                    row.innerHTML = `
                        <td>${client.id}</td>
                        <td>${client.name || ""} <span class="badge pending">Pendente</span></td>
                        <td>${client.phone || ""}</td>
                        <td>${client.email || ""}</td>
                        <td>${contactDate}</td>
                        <td class="actions">
                            <button class="assign-broker" data-id="${client.id}">Atribuir Corretor</button>
                            <button class="edit" data-id="${client.id}">Editar</button>
                            <button class="delete" data-id="${client.id}">Excluir</button>
                        </td>
                    `;

                    tableBody.appendChild(row);
                });

                // Adicionar event listeners para botões
                document.querySelectorAll("#pending-clients-table-body .assign-broker").forEach(button => {
                    button.addEventListener("click", function() {
                        const id = this.getAttribute("data-id");
                        if (typeof showAssignBrokerDialog === 'function') {
                            showAssignBrokerDialog(id);
                        } else {
                            console.warn("Função showAssignBrokerDialog não encontrada");
                        }
                    });
                });

                document.querySelectorAll("#pending-clients-table-body .edit").forEach(button => {
                    button.addEventListener("click", function() {
                        const id = this.getAttribute("data-id");
                        if (typeof showForm === 'function') {
                            showForm("client", id);
                        } else {
                            console.warn("Função showForm não encontrada");
                        }
                    });
                });

                document.querySelectorAll("#pending-clients-table-body .delete").forEach(button => {
                    button.addEventListener("click", function() {
                        const id = this.getAttribute("data-id");
                        if (confirm("Tem certeza que deseja excluir este cliente?")) {
                            const clients = JSON.parse(localStorage.getItem("clients") || "[]");
                            const updatedClients = clients.filter(client => client.id !== id);
                            localStorage.setItem("clients", JSON.stringify(updatedClients));
                            loadPendingClients();
                        }
                    });
                });
            } catch (error) {
                console.error("Erro ao carregar tabela de clientes pendentes:", error);
            }
        }

        // Configurar evento de clique para o botão de visualizar clientes pendentes
        viewPendingClientsBtn.addEventListener("click", function() {
            console.log("Botão de visualizar clientes pendentes clicado");
            
            // Esconder as visualizações de clientes
            clientsListView.style.display = "none";
            clientsKanbanView.style.display = "none";
            clientsKanbanView.classList.remove("visible");
            
            // Desativar botões de visualização
            document.querySelectorAll(".view-toggle-btn").forEach(btn => {
                btn.classList.remove("active");
            });
            
            // Mostrar a seção de clientes pendentes
            pendingClientsSection.style.display = "block";
            
            // Carregar os clientes pendentes
            loadPendingClients();
        });

        // Configurar evento de clique para o botão de fechar clientes pendentes
        closePendingClientsBtn.addEventListener("click", function() {
            console.log("Botão de fechar clientes pendentes clicado");
            
            // Esconder a seção de clientes pendentes
            pendingClientsSection.style.display = "none";
            
            // Mostrar a visualização em lista
            clientsListView.style.display = "block";
            
            // Ativar o botão de visualização em lista
            document.querySelector(".view-toggle-btn[data-view='list']").classList.add("active");
        });
    }
    
    // Verificar se o usuário atual é admin ou dev para mostrar/esconder o botão
    const currentUser = JSON.parse(localStorage.getItem("currentUser") || "{}");
    if (!["admin", "dev"].includes(currentUser.role)) {
        // Esconder o botão se não for admin ou dev
        if (viewPendingClientsBtn) {
            viewPendingClientsBtn.style.display = "none";
        }
    }
});
</script>
<!-- Adicionar o script de notificações antes do fechamento do body -->
<script src="../src/js/csv-handler.js"></script>
<script src="../src/js/admin.js"></script>
<script src="../src/js/database-manager.js"></script>
<script src="../src/js/notification-manager.js"></script>
<!-- Adicionar script para garantir que os botões funcionem corretamente -->
<!-- Adicionar o script do dashboard-updater.js antes do fechamento do body -->
<script src="../src/js/dashboard-updater.js"></script>
<!-- Adicionar script para o botão de atualizar logs -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  const refreshLogsBtn = document.getElementById("refresh-logs-btn");
  if (refreshLogsBtn) {
    refreshLogsBtn.addEventListener("click", function() {
      // Recarregar os logs
      if (typeof loadActivityLogs === 'function') {
        loadActivityLogs();
      }
    });
  }
});
</script>
</body>
</html>
